digraph cluster0 {
	nodesep=.05;
	ranksep=0.05
	node [shape=record, height=.1];

	subgraph selection {
		node [style=filled; fillcolor="yellow"]
		ksel; ressel
	}

	subgraph procedure {
		node [style=filled; fillcolor="lightpink"]
		e; cv; sil; gsea0; gsea1; hyper
	}

	subgraph param {
		node [style=filled; fillcolor="lightgrey"]
		pheno; a; b; c; knn; clust
	}

	subgraph clusterortho {
		style=filled;
		color=lightblue;
		label="ortholog lookup";
		sdb; prot; 
	}

	subgraph cluster4 {
		style=filled;
		color=lightblue;
		label="clustering";
		knn; gsea0; ksel; leiden
	}

	subgraph clustersel {
		style=filled;
		color=lightblue;
		label="cluster selection";
		sil; gsea1; ressel
	}


	subgraph cluster5 {
		style=filled;
		color=lightblue;
		label="bootsrapping";
		train; test; knnsub; classifier; cv
	}

	subgraph clustereval {
		style=filled;
		color=lightblue;
		label="cluster evaluation"
		hyper; gene
	}

	pheno [label="26 perturbations"];
	a [label="{<a0> segmentation | 1703 embryo halves}"];
	b [label="{<b0> preprocessing | 114 summary statistics}"];

	e [label="autoencoder"]

	c [label="encoding"];
	knn [label="{<a> knn graph | k ∈ \{3,4,...,50\}}"];
	sil [label="silhouette \nwidth"];
	leiden [label="leiden algorithm"];
	clust [label="{<a> clusters | <b> γ ∈ ℝ \> 0}"]

	train [label="{training set | 90% data}"];
	test [label="{test set | 10% data}"];
	knnsub [label="reduced \nknn graph"];
	classifier [label="reduced knn \nclassifier"];
	cv [label="crossvalidation"];
	
	hyper [label="hypergeometric\ntest"];

	sdb [label="{STRINGdb}"]
	prot [label="protein interaction\nnetwork"]
	gsea0 [label="{<a> GSEA | <b> sorted by count}"]
	gsea1 [label="{GSEA | sorted by modularity}"]
	
	ksel [label="k selection"]
	ressel [label="γ selection"]

	gene [label="gene network"]

	pheno -> {a hyper};
	a -> b -> e -> c -> knn -> ksel -> leiden -> clust -> classifier;
	c -> {train; test}
	
	train -> knnsub -> classifier -> cv
	test -> cv -> ressel;
	clust -> sil -> ressel;

	pheno -> sdb -> prot ->  gsea0 -> ksel
	clust -> gsea1 -> ressel -> hyper
	clust -> ressel

	knn -> {gsea0; gsea1}

	prot -> gene
	ressel -> gene
}





