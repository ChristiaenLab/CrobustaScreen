digraph cluster0 {
	nodesep=.05;
	ranksep=0.05
	node [shape=record, height=.1];


	subgraph clusterortho {
		style=filled;
		color=lightblue;
		label="ortholog lookup";
		sdb; prot; 
	}


	subgraph clusterc {
		style=filled;
		color=lavender;
		label="clustering";
		subgraph cluster0 {
			style="";
			color=black;
			label="k selection";
			gsea0; inter;
		}
		d; knn; leiden;
	}

	pheno [label="26 perturbations"];
	e [label="autoencoder"];
	aic [label="embedding selection"];

	d [label="euclidean \ndistance"];
	knn [label="{<a> knn graph | k ∈ \{3,4,...,50\}}"];
	inter [label="gene interaction network"]

	sdb [label="{STRINGdb}"]
	prot [label="protein interaction\nnetwork"]
	gsea0 [label="{<a> GSEA | <b> sorted by count}"]

	leiden [label="leiden algorithm"];
	clust [label="{<a> clusters | <b> γ ∈ ℝ \> 0}"]

	ressel [label="γ selection"]

	eval [label="cluster charactrization"]
	pheno -> e -> aic -> d -> knn -> inter;
	inter -> gsea0 -> leiden -> clust
	knn -> leiden;
	
	pheno -> sdb -> prot ->  gsea0
	clust -> ressel -> eval
}

