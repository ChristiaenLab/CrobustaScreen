digraph cluster0 {
	nodesep=.05;
	ranksep=0.05
	node [shape=record, height=.1];

	subgraph clustera{
		label="autoencoder"
		style=filled;
		color=lavender;
		e0; e2;

		subgraph cluster1 {
			style="";
			color=black;
			label="embedding layer"
			bot
		}
	}


	subgraph clusterb{
		label="embedding selection"
		style=filled;
		color=lightblue;
		mse; aic;
		subgraph cluster3 {
			style="";
			color=black;
			label="decoded output"
			out
		}
	}


	pheno [label="26 perturbations"];
	a [label="{<a0> segmentation | 1831 embryo halves}"];
	b [label="{<b0> preprocessing | 116 summary statistics}"];

	e0 [label="encoder"]
	bot [label="<b0> n = 14 | <b1> n = 7 | <b2> n = 3 | <b3> n = 2"]
	e2 [label="decoder"]
	out [label="<o0> n = 116 | <o1> n = 116 | <o2> n = 116 | <o3> n = 116"]

	mse [label="MSE"]
	aic [label="AIC"]

	clust [label="clustering"]
	sel [label="cluster selection"]
	eval [label="cluster characterization"]


	pheno -> a -> b -> e0  

	e0 -> bot:b0
	e0 -> bot:b1
	e0 -> bot:b2
	e0 -> bot:b3

	bot:b0 -> e2
	bot:b1 -> e2
	bot:b2 -> e2
	bot:b3 -> e2


	e2 -> out:o0
	e2 -> out:o1
	e2 -> out:o2
	e2 -> out:o3

	out:o0 -> mse 
	out:o1 -> mse
	out:o2 -> mse
	out:o3 -> mse;


	mse -> aic -> clust -> sel -> eval
	bot:b3 -> clust
}
